{{ coach }}
<!DOCTYPE html>
<html lang="en">
<head>
    {% block title %}
    <title>Coach</title>
    {% endblock %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% load static %}
    <link rel="stylesheet"
          type="text/css"
          href="{% static 'question_queue/css/style.css' %}" />
    <script src="{% static 'question_queue/js/instructor.js' %}"></script>
    <link rel="stylesheet"
          type="text/css"
          href="{% static 'question_queue/css/style.css' %}" />
    <link rel="shortcut icon" type="image/png" href="{% static 'favicon.ico' %}" >
    {% include "./bootstrap.html" %}
</head>
<body>
    <div class="instr-page">
        <br>
        <h1 class="turn-light">Coach Page</h1>
        <div class="filter" style="display: flex; flex-direction: row">
            <form action="" method="post">
                {% csrf_token %}
                <button name="filter_queue" value="open">Open Questions</button>
                <button name="filter_queue" value="answered">Answered Questions</button>
                <button name="filter_queue" value="question-queue">Question Queue</button>
            </form>
        </div>

        <div id="queue-table">
            {% include "./question_table.html" %}
        </div>
    </div>

    <!-- WebSocket Javascript -->
    <script>
        function hookQueueEntries() {
            document.querySelectorAll(".queue-entry").forEach((e) => {
            e.addEventListener("submit", (e) => {
              websocket.send(
                JSON.stringify({
                  question_id: e.target.id,
                  action: e.submitter.name,
                })
              );
              e.preventDefault();
            });
          });
        }
        hookQueueEntries();

        const websocket = new WebSocket("ws://" + window.location.host + "/ws/coach/");

        websocket.onmessage = (e) => {
          const data = JSON.parse(e.data);
          document.querySelector(data.element).innerHTML = data.html;
          hookQueueEntries();
        };

        websocket.onclose = (e) => {
          console.error("Socket closed unexpectedly");
        };
      </script>
</body>
</html>
