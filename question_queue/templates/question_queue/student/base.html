{{ student }}
<!DOCTYPE html>
<html lang="en">

<head>
    {% block title %}
    <title>Student</title>
    {% endblock %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% load static %}
    <link rel="stylesheet" type="text/css" href="{% static 'question_queue/css/style.css' %}" />
    <link rel="shortcut icon" type="image/png" href="{% static 'favicon.ico' %}" >
    {% include "../bootstrap.html" %}
</head>

<body id="body">
    <header>
        <label class="toggle-dark hidden">
            <input type="checkbox" id="toggle-dark hidden" />
            <span class="slider">
        </label>
    </header>
    {% block header %}
    <h1>Student Page</h1>
    {% endblock %}
    <div id="pop" hidden="true"></div>
    <!-- Child can decide to override this content -->
    {% block content %} {% endblock %}

    <div class="container">
        <br />

        <!-- Include row 1 -->
        {% include "./row1/component1.html" %}
        <h1 class="turn-light">College of Computing Learning Center</h1>

        <!-- Ask a question -->
        {% include "./ask_a_question.html" %}

        <!-- Queue Position -->
        <hr/>
        <span id="queue-position"></span>
    </div>

    <script>
        const element = document.getElementById("ask-question-form");
        element.addEventListener("submit", (e) => {
            websocket.send(
                JSON.stringify({
                    action: "create",
                    args: {
                        course: document.getElementById("id_course").value,
                        message: document.getElementById("id_question").value
                    }
                })
            )
            e.preventDefault()
        });
    </script>

    <!-- WebSocket Javascript -->
    <script>
        const websocket = new WebSocket("ws://" + window.location.host + "/ws/student/");

        websocket.onmessage = (e) => {
            const template = document.createElement("template");
            template.innerHTML = e.data.trim();
            for (const node of template.content.childNodes) {
                const dom_node = document.getElementById(node.id);
                if (dom_node){
                    dom_node.outerHTML = node.outerHTML;
                }
            }
        };

        websocket.onclose = (e) => {
            console.error("Socket closed unexpectedly");
        };
    </script>
</body>

</html>
